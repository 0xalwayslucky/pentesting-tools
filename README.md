# own tools
template-ish tools probably going to be developed over time or merged together into one
### enumeration
- **checknullsmb.sh** - attemts to connect to default shares on the target smbserver via null session
- **discover_hosts.py** - brute forces hosts on the target webserver with a given wordlist
- **discover_params.py** - brute forces parameters on the target url with a given wordlist
- **ldap3client.py** - interactive client for ldap (modify/add functions are not implemented correctly yet). Currently only supports NTLM authentication.
- **methodtesting.py** - tests well-known methods of HTTP against target urls
- **nmap.sh** - first enumerates all ports and then runs os/version detection, script scanning and traceroute against the open ports.
### exploitation
- **brutedefaultsmb.sh** - brute forces well-known default credentials on target smbserver for the share IPC$
- **brutesmb.sh** - brute forces credentials on target smbserver for the share IPC$
- **ldapdumppwd.py** - dump msDS-Password or LAPS password
- **sqli_template.py** - template for error based as well as time based blind sql injection. Current configuration is for reading char-wise from a database, validated by time-based responses from the application. Examples for queries can be found in the examples folder.
- **xp_cmdshell.py** - interactive mssql xp_cmdshell with auto reconnect after connection is reset by server. Contains the ability to upload files/binaries in a staged manner via base64 convertion and add-content function of powershell. Also supports powershell instead of default cmd commands when activated.
### utilities
- **file2hex.sh** - converts file to copy-pastable hexdump
- **getyaml.py** - prints yaml serialized output of given class
- **matchregex.py** - prints lines that matches the given regex
- **namedpipe_listen.py** - creates a named pipe and listens for a connection. After connection the recieved message will be dumped
- **namedpipe_write.py** - connects to a given named pipe and sends a message
- **stringtohex.py** - converts a string to hexadecimal representation in the following format: \x41\x41\x41


# public tools
collection of public tools
## linux
[bundler-audit](https://github.com/rubysec/bundler-audit)\
[C-Reverse-Shell](https://github.com/dev-frog/C-Reverse-Shell)\
[evil-winrm](https://github.com/Hackplayers/evil-winrm)\
[FallofSudo](https://github.com/Critical-Start/FallofSudo)\
[fimap](https://github.com/kurobeats/fimap.git)\
[krbrelayx](https://github.com/dirkjanm/krbrelayx)\
[lazys3](https://github.com/nahamsec/lazys3.git)\
[linux-exploit-suggester](https://github.com/mzet-/linux-exploit-suggester.git)\
[logrotten](https://github.com/whotwagner/logrotten)\
[marshalsec](https://github.com/mbechler/marshalsec)\
[MITMf](https://github.com/byt3bl33d3r/MITMf.git)\
[MS17-010](https://github.com/worawit/MS17-010.git)\
[NetNTLMtoSilverTicket](https://github.com/NotMedic/NetNTLMtoSilverTicket)\
[phpggc](https://github.com/ambionics/phpggc)\
[PRET](https://github.com/RUB-NDS/PRET)\
[privilege-escalation-awesome-scripts-suite](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git)\
[Responder](https://github.com/SpiderLabs/Responder.git)\
[Rogue-MySql-Server](https://github.com/allyshka/Rogue-MySql-Server.git)\
[SMBrute](https://github.com/m4ll0k/SMBrute.git)\
[Sublist3r](https://github.com/aboul3la/Sublist3r.git)\
[su-bruteforce](https://github.com/carlospolop/su-bruteforce.git)\
[WAFNinja](https://github.com/khalilbijjou/WAFNinja)\
[Windows-Exploit-Suggester](https://github.com/GDSSecurity/Windows-Exploit-Suggester.git)

### manually added / don't overwrite
[Namemash](https://gist.github.com/superkojiman/11076951)\
[ghidra](https://ghidra-sre.org/)

## windows
[CeWL](https://github.com/digininja/CeWL)\
[ExploitRemotingService](https://github.com/tyranid/ExploitRemotingService)\
[IOXIDResolver](https://github.com/mubix/IOXIDResolver)\
[MailSniper](https://github.com/dafthack/MailSniper)\
[powercat](https://github.com/besimorhino/powercat)\
[PowerShell-Suite](https://github.com/FuzzySecurity/PowerShell-Suite)\
[privilege-escalation-awesome-scripts-suite](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite)\
[PSByPassCLM](https://github.com/padovah4ck/PSByPassCLM)\
[Rubeus](https://github.com/GhostPack/Rubeus)\
[username-anarchy](https://github.com/urbanadventurer/username-anarchy)\
[Windows-Exploit-Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)

### manually added / don't overwrite
[Apimonitor](http://www.rohitab.com/apimonitor)\
[Sysinternals](https://docs.microsoft.com/en-us/sysinternals/)\
[x64dbg](https://x64dbg.com/#start)\
[kekeo](https://github.com/gentilkiwi/kekeo)\
[mimikatz](https://github.com/gentilkiwi/mimikatz)\
[mingw-w64](http://mingw-w64.org/doku.php)\
[wget](https://eternallybored.org/misc/wget/)\
[ncat](https://nmap.org/ncat/)\
[nmap](https://nmap.org/download.html)\
[nc.exe](https://eternallybored.org/misc/netcat/)\
[curl](https://curl.se/windows/)\
[putty](https://www.putty.org/)\
[hydra](https://github.com/maaaaz/thc-hydra-windows)\
[metasploit](https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers)\
[msbuild](https://visualstudio.microsoft.com/de/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16)\
[ghidra](https://ghidra-sre.org/)\
[hashcat](https://hashcat.net/hashcat/)\
[john](https://www.openwall.com/john/)\
[ida-free](https://hex-rays.com/ida-free/)\
[ysoserial.net](https://github.com/pwntester/ysoserial.net)\
[CANAPE.Core](https://github.com/tyranid/CANAPE.Core)\
[Bloodhound](https://bloodhound.readthedocs.io/en/latest/installation/windows.html)\
[Process Hacker](https://processhacker.sourceforge.io/downloads.php)

## scripts
### generate [this](#linux) public tool list for linux
```bash
#!/bin/bash
# Generate link list (in github markup format) for tools in current directory, that have been downloaded with git
# Last \ has to be removed (to lazy to change that rn :D)

for fn in $PWD/*; do 
    if [[ -d $fn ]]; then 
        cd $fn; 
        link=$(git remote -v 2>/dev/null | head -n1 | cut -d '	' -f2 | cut -d ' ' -f1); 

        if [[ -n $link ]]; then
            name=$(echo $link | rev | cut -d '/' -f1 | rev)
            if [[ $name == *".git"* ]]; then
                name=$(echo $name | cut -d '.' -f1)
            fi
            echo "[$name]($link)\\"
        fi

        cd ..; 
    fi; 
done

````

### generate [this](#windows) public tool list for windows
```powershell
# Generate link list (in github markup format) for tools in current directory, that have been downloaded with git
# Last \ has to be removed (to lazy to change that rn :D)

$ErrorActionPreference = 'Stop' # catch block when error occours
$dirs = Get-ChildItem -Directory .

foreach($dir in $dirs) {
    cd $dir

    $error.clear() # clear previous error
    try{
        $line = (git remote -v).split([Environment]::NewLine) | Select -First 1

        # extract link and strip .git from the end
        $link = $line.split('	')[1].split(' ')[0]
        if($link -match "\.git"){
            $link = $link.Substring(0, $link.LastIndexOf('.'))
        }

        # start at last / (+1 to exclude the /) until end of string to get the name for the link
        $startchar = $link.LastIndexOf('/') + 1
        $length = $link.Length
        $name_link = $link.Substring($startchar, $length - $startchar)

        # output github markdown format
        echo "[$name_link]($link)\"
    } catch {} # do nothing when error (most likely from git remote -v within non git dir)

    cd ..
}
```
# compiling
## windows
```cmd
csc.exe -o program.exe csharp.cs
x86_64-w64-mingw32-g++.exe -o program.exe cplusplus64.cpp
i686-w64-mingw32-g++.exe -o program.exe cplusplus32.cpp
x86_64-w64-mingw32-gcc.exe -o program.exe cfile64.c
i686-w64-mingw32-gcc.exe -o program.exe cfile32.c
msbuild.exe project.csproj
```

# disable windows defender permanently
> tested on Microsoft Windows 10 Pro 10.0.19042 x64
- need permissions >= admin (high integriy)

> Tamper Protection has to be disabled (only way I found to do that is via GUI, all other approaches didn't work since the reason for it to exists is to prevent programs from modifying the configuration of the AV, which is for example via malicious program or command line)
- Windows Security -> Virus & threat protection -> Tamper Protection


## disable realtime monitoring
> the commands below disable realtime monitoring and add a registry value that disables the Windows defender permanently
### cmd
```powershell
powershell -command "Set-MpPreference -DisableRealtimeMonitoring $true" && reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender" /v DisableAntiSpyware /t REG_DWORD_LITTLE_ENDIAN /d 1 /f
```
### powershell
```powershell
Set-MpPreference -DisableRealtimeMonitoring $true; New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force;
```

# disclaimer
All scripts should be used for authorized penetration testing purposes only. Any misuse will not be the responsibility of the author.
