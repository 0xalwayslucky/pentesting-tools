import requests
import re

url = ''

def get_content_length():
    resp = requests.get(url)
    if resp.status_code == 200:
        return resp.headers['content-length']
    return -1

def bf_hosts(path):
    host_file = open(path, 'r')
    main_length = get_content_length()
    if main_length != -1:
        for line in host_file:
            line = line.rstrip()
            host = line + '.' + url.split('//')[1]
            resp = requests.get(url, headers={'Host': host})
            if resp.headers['content-length'] != main_length:
                if resp.status_code == 200:
                    print('[+] Host found: {}'.format(host))
                else:
                    print('[*] response varies from usual responses. Got status code {} for host {}'.format(resp.status_code, host))
    else:
        print('check url, invalid content length for main page.')


if __name__ == "__main__":
    path = '../subdomains.txt'
    bf_hosts(path)
    
