# Python application to communicate with a named pipe 
# requires: pip install pywin32
# run pyinstaller --onefile namedpipe_write.py to create an exe for windows
import win32pipe, win32file, pywintypes, sys

handle = win32file.CreateFile(r'\\.\pipe\examplePipe', win32file.GENERIC_READ | win32file.GENERIC_WRITE, 0, None, win32file.OPEN_EXISTING, 0, None)

string = sys.argv[1] 
win32file.WriteFile(handle, string.encode('UTF-8'))
print(string.encode('UTF-8'))
win32file.CloseHandle(handle)
