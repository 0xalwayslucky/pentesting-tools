# creates a named pipe, listens for a connection and dumps the message
# requires: pip install pywin32
# run pyinstaller --onefile namedpipe_listen.py to create an exe for windows
import win32pipe, win32file, pywintypes

handle = win32pipe.CreateNamedPipe(r'\\.\pipe\examplePipe', win32pipe.PIPE_ACCESS_DUPLEX, win32pipe.PIPE_TYPE_MESSAGE | win32pipe.PIPE_WAIT, 1, 65536, 65536, 300, None)
win32pipe.ConnectNamedPipe(handle, None)
print('client connected.')
print(win32file.ReadFile(handle, 64*1024))
win32file.CloseHandle(handle)
